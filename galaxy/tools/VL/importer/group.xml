<tool id="vl_import_study" name="VLI.study">
  <description>Create a new group within omero/vl</description>
  <command interpreter="python">
    #if $__app__.config.vl_import_enabled_users.split(',').count($__user_email__)==1 #importer.py
    #else #unauthorized_access.py
    #end if
    #if str($advanced_configuration.configuration_level) == 'advanced'
      --host=$advanced_configuration.vl_host
      --user=$advanced_configuration.vl_user
      --passwd=$advanced_configuration.vl_passwd
    #else
      --host=$__app__.config.omero_default_host
      --user=$__app__.config.omero_default_user
      --passwd="$__app__.config.omero_default_passwd"
    #end if
    --operator=galaxy
    --ifile=$input1
    --ofile=$output1
    --loglevel=$__app__.config.vl_loglevel
    --logfile=${logfile}
    group
   #if str($group_label) != ''
    --group=$group_label
   #end if
  </command>  
  <inputs>
    <param format="tabular" name="input1" type="data"
	   label="A tabular dataset with the following columns ..."/>

    <param name="group_label" size="40" type="text" 
	   value="" 
	   label="New group label"/>

    <conditional name="advanced_configuration">
      <param name="configuration_level" type="select" 
	     label="Configuration level">
	<option value="default" selected="true">Default configuration</option>	
	<option value="advanced">Advanced configuration</option>
      </param>
      <when value="advanced">
	<param name="vl_host" size="40" type="text" 
	       value="localhost" 
	       label="Omero/VL host"/>
	<param name="vl_user" size="20" type="text" 
	       value="root" 
	       label="Omero/VL user"/>
	<param name="vl_passwd" size="20" type="text" 
	       value="What?Me worry?" 
	       label="Omero/VL passwd"/>
      </when>
      <when/>
    </conditional>
  </inputs>
  <outputs>
    <data format="tabular" name="output1" label="${tool.name}.mapping"/>
    <data format="txt" name="logfile"     label="${tool.name}.logfile"/>
  </outputs>
  <help>
Will create a new group of individuals from a file with the following columns::

   study   label   individual
   foo     I0000   V06C59B915C0FD47DABE6AE02C731780AF
   foo     I0001   V0B718B77691B145BFA8901FCCF6B37998
   ...

where the column study is optional (it can be provided via the
group_label param). Labels should be unique within the file and the
individual field should contain VIDs of existing (within omero/vl)
Individual objects.
  </help>
</tool>
