<tool id="vl_tools_merge_individuals" name="VLU.merge_individuals">
  <description>
    Merge individuals' data
  </description>
  <command interpreter="python">
    merge_individuals.py
    #if $advanced_configuration.configuration_level == 'advanced'
      --host=${advanced_configuration.vl_host}
      --user=${advanced_configuration.vl_user}
      --passwd=${advanced_configuration.vl_passwd}
    #end if
    --loglevel=$__app__.config.vl_loglevel
    --logfile=${logfile}
    --in_file=${input}
    --operator=galaxy
  </command>
  <inputs>
    <param format="tabular" name="input" type="data"
	   label="A tabular dataset with the following columns ..."/>

    <!-- ************************************************** -->
    <conditional name="advanced_configuration">
      <param name="configuration_level" type="select" 
	     label="Configuration level">
	<option value="default" selected="true">Default configuration</option>	
	<option value="advanced">Advanced configuration</option>
      </param>
      <when value="default"/>
      <when value="advanced">
	<param name="vl_host" size="40" type="text" value="localhost" 
	       label="Omero/VL host"/>
	<param name="vl_user" size="20" type="text" value="root" 
	       label="Omero/VL user"/>
	<param name="vl_passwd" size="20" type="text" value="What?Me worry?" 
	       label="Omero/VL passwd"/>
      </when>
    </conditional>
  </inputs>
  
  <outputs>
    <data format="txt" name="logfile" label="${tool.name}.log"/>
  </outputs>

  <help>
This tool moves all informations related to an individual (source) to
another (target). Moved informations are:

 * children (Individual objects)
 * ActionOnInvidual
 * Enrollments
 * EHR records

The tool expects as input a TSV file like this::

 source                               target
 V0468D2D96999548BF9FC6AD24C055E038   V060BAA01C662240D181BB98A51885C498
 V029CC0A614E2D42D0837602B15193EB58   V01B8122A7C75A452E9F80381CEA988557
 V0B20C93E8A88D43EFB87A7E6911292A05   V0BED85E8E76A54AA7AB0AFB09F95798A8
 ...

NOTE WELL: 
 * Parents of the "source" indivudal WILL NOT BE ASSIGNED
   to the "target" individual
 * For the Enrollmnent objects, if
   "target" individual has already a code in the same study of "source"
   individual, the script will try to move the Enrollment to the
   "duplicated" study
  </help>
</tool>